---

## üîß BROWSER ISSUES & TECHNICAL DEBT (Added 2025-12-01)

### Accessibility Issues (HIGH PRIORITY)
- [x] Images must have alternate text: Add alt attributes to all img tags (‚úÖ Completed - logo has alt text)
- [ ] Frames/iframes must have accessible name: Add title attributes to iframes (AdSense - N/A, generated by AdSense)

### Compatibility Issues (MEDIUM PRIORITY)
- [ ] Fix 'content-type' header charset to 'utf-8' in nginx/backend
- [ ] Fix 'content-type' header media type to 'text/html' not 'text/javascript' (Google scripts - can't fix)
- [x] Remove unsupported 'font-size-adjust' CSS property (‚úÖ Not found in codebase - false positive)
- [x] Fix 'min-height: auto' for Firefox 22+ compatibility (‚úÖ Not found in codebase - false positive)
- [x] Move 'charset' meta element to be first thing in '<head>' (‚úÖ Completed 2025-12-01)

### Performance Issues (MEDIUM PRIORITY)
- [x] Add 'cache-control' header to nginx config (‚úÖ Completed - 7d for static files)
- [ ] Remove 'must-revalidate' directive from cache-control headers (Google scripts - can't fix)
- [ ] Remove 'no-store' directive from cache-control headers (Google scripts - can't fix)
- [x] Remove unneeded 'x-xss-protection' header from nginx (‚úÖ Completed - replaced with CSP)
- [ ] Optimize 'box-shadow' in @keyframes animations (paint trigger) - Low priority
- [ ] Optimize 'transform' in @keyframes animations (paint trigger) - Low priority

### Security Issues (MEDIUM PRIORITY)
- [ ] Remove deprecated 'P3P' header (IE-only, non-standard) (Google scripts - can't fix)
- [ ] Remove deprecated 'Pragma' header (use Cache-Control instead) (Google scripts - can't fix)
- [x] Replace 'X-Frame-Options' with 'Content-Security-Policy: frame-ancestors' (‚úÖ Completed 2025-12-01)

### Code Quality Issues (LOW PRIORITY)
- [ ] Reorder CSS: 'transform' should be listed after '-webkit-transform'
- [ ] Move all inline styles to external CSS files
- [ ] Fix Page layout Quirks Mode issue (ensure DOCTYPE is correct)

---

### User Profile Features
- Profile page (separate from account settings)
  - Avatar upload and management
  - Editable bio/info
  - Recent activity display
  - Quick links to privacy/settings

---

## üéØ RECOMMENDED NEXT ACTIONS

Based on this analysis, here's what I recommend we do **right now**:

### 1. Test the templating system (5 minutes)
- Verify all pages load correctly
- Check that header appears on all pages
- Confirm auth buttons work properly

### 2. Add admin link to menu (15 minutes) [PENDING]
- Add conditional admin link to base.html
- Check if user.is_admin from backend
- Test visibility for admin vs non-admin users

### 3. Fix article modal issues (20 minutes) [PARTIALLY COMPLETE]
- [x] Add ESC key handler to close modal (‚úÖ Already implemented)
- [x] Fix body scroll lock when modal opens (‚úÖ Completed - Fire TV bug fix)
- [ ] Verify back button closes modal
- [ ] Test X button on mobile devices

### 4. User review of login page (5 minutes)
- Ask if current layout is satisfactory
- Mark as complete if approved

**Total effort: ~45 minutes for 4 high-value tasks**

---

## üìã KEPT FOR REFERENCE (Old Completed Items)
# Project Todo List - Prioritized

## ‚úÖ COMPLETED FEATURES

### Core UI/UX (Recently Completed 2025-11-30 to 2025-12-01)
- [x] Hamburger menu positioned on far right of header (‚úÖ Completed 2025-12-01)
- [x] Menu icons above text (not beside) (‚úÖ Completed 2025-12-01)
- [x] Menu layout: 2 items per row (‚úÖ Completed 2025-12-01)
- [x] Dark mode button beside Feed in menu (‚úÖ Completed 2025-12-01)
- [x] Dark mode as default on page load (‚úÖ Completed 2025-12-01)
- [x] Dark mode preference persistence (‚úÖ Completed 2025-12-01)
- [x] Body scroll lock when article modal opens (‚úÖ Completed - Fire TV compatibility)
- [x] Domain migration from nexus.comdat.ca to comdat.ca (‚úÖ Completed 2025-12-01)
- [x] AdSense auto-ads code installed (‚úÖ Completed 2025-12-01)
- [x] Fact extraction for AdSense compliance (‚úÖ Completed 2025-12-01)
- [x] AdSense ads.txt file created (‚úÖ Completed 2025-12-01)
- [x] AdSense setup and approval complete (‚úÖ Completed 2025-12-01)
- [x] Webhook endpoint at comdat.ca/webhook (‚úÖ Completed 2025-12-01)
- [x] Browser issues fixed (charset, headers, CSP) (‚úÖ Completed 2025-12-01)

### Core UI/UX (Previously Completed 2025-11-30 to 2025-12-01)
- [x] Settings page with sidebar navigation and history tabs
- [x] Navigation/menu system with hamburger, responsive design
- [x] Dark mode toggle (mobile and desktop, persists)
- [x] Dark mode as default with no flash on page load
- [x] Hamburger menu with consolidated code
- [x] Category filter buttons at top
- [x] Font size controls with smart exclusions
- [x] End of feed indicator
- [x] New stories first + infinite scroll
- [x] YouTube-style images with color extraction
- [x] On-demand story scraping with caching
- [x] Jinja2 templating system (header in one file!)
- [x] History tracking for anonymous users
- [x] Favicon and circular logo branding
- [x] Clickable header to return to feed

---

## üî¥ HIGH PRIORITY (Should Do Next)

### 1. Hide login page after login [PARTIALLY COMPLETE - NEEDS TESTING]
**Status**: Backend logic exists, needs verification
- ‚úÖ Backend checks token validity in `/login` route
- ‚úÖ Redirects to `/` if valid token exists
- ‚úÖ Clears invalid tokens
- ‚ö†Ô∏è Need to verify this works after templating changes
- **Priority**: HIGH - Security/UX issue
- **Effort**: Low (just testing)

### 2. Add admin spot in hamburger menu [EASY WIN]
**Status**: Logic exists, just needs integration
- ‚ö†Ô∏è Admin check exists in old index.html JavaScript
- ‚ö†Ô∏è Needs to be added to base.html template
- ‚ö†Ô∏è Conditional rendering based on user.is_admin
- **Priority**: HIGH - Required for admin access
- **Effort**: Low (15 minutes)
- **Blocker**: Need to determine if admin link should be visible in menu or as separate route

### 3. Improve login page layout [PROBABLY COMPLETE]
**Status**: Already redesigned extensively
- ‚úÖ Vertical alignment fixed with form-row-inline
- ‚úÖ Mobile responsive with media queries
- ‚úÖ Side-by-side buttons
- ‚úÖ Social login buttons styled
- ‚úÖ Error messages centered
- ‚úÖ Password validation with visual feedback
- **Action**: Just needs user confirmation it's satisfactory

### 4. Fix pop-up card X button and UX [NEEDS INVESTIGATION]
**Status**: Article modal exists, needs review
- ‚ö†Ô∏è Need to check if X button is visible/functional
- ‚ö†Ô∏è Check if back button closes modal
- ‚ö†Ô∏è Check if ESC key closes modal
- **Priority**: MEDIUM - UX enhancement
- **Effort**: Low (add event listeners)

---

## üü° MEDIUM PRIORITY (Content & Polish)

### 5. Create privacy policy [CONTENT NEEDED]
- Placeholder text exists in settings page
- Need actual legal content
- **Priority**: MEDIUM - Legal requirement before public launch
- **Effort**: Medium (requires legal review)

### 6. Create terms of service [CONTENT NEEDED]
- Placeholder text exists in settings page
- Need actual legal content
- **Priority**: MEDIUM - Legal requirement before public launch
- **Effort**: Medium (requires legal review)

### 7. Lighten pop-up window colors [NEEDS TESTING]
- Article modal has styling for light/dark mode
- Need to verify colors are distinct enough
- **Priority**: LOW - Polish
- **Effort**: Low (CSS tweaks)

### 8. Apply dark mode to pop-up pages [LIKELY COMPLETE]
- Article modal has dark mode CSS in feed.css
- Need to verify it switches properly
- **Priority**: LOW - Polish
- **Effort**: Low (testing)

---

## üü¢ LOWER PRIORITY (Future Enhancements)

### Content Quality & Intelligence
- Balance story categories (tune algorithm)
- RSS feed search by category
- Differentiate stories by title (AI/NLP)
- Handle duplicate stories (deduplication)
- AI bullet facts for stories (requires AI service)
- AI suggest targeted story methods
- AI suggest user tracking improvements
- AI suggest changes/upgrades

### Monetization (Not Yet Ready)
- Sign up for multiple ad sites
- Place ads on site
- Add Google Analytics tracking
- Track ad views and CTR in DB

### Analytics & Tools
- Setup Beaver for DB analysis
- AI suggest DB columns for tracking

### Advanced Features
- Add profile page (separate from account settings)
- Restore previous feed on back after refresh

---

## üìä PRIORITY ANALYSIS

### Do FIRST (This Session):
1. **Test templating system** - Verify all pages load correctly
2. **Add admin link** - Quick win, 15 minutes
3. **Verify login redirect** - Confirm security works
4. **Test article modal** - Check X button, ESC key, back button

### Do NEXT (Soon):
1. Privacy policy & Terms of Service (legal content)
2. Pop-up window color/UX refinements
3. Profile page (if different from settings/account)

### Do LATER (Future):
1. Content quality improvements (AI, deduplication)
2. Monetization (ads, analytics)
3. Advanced tracking and analytics

---

#### Key Security Tests for Website

1. Input Validation & Injection Testing [‚úÖ COMPLETE]
- [x] SonarLint analysis enabled for SQL/injection detection
- [x] Run manual SQL injection tests - PASSED (SQLAlchemy ORM prevents injection)
- [x] Test command injection vectors - PASSED (no shell commands from user input)
- [x] Validate user inputs with strict whitelisting - VERIFIED

2. Authentication & Session Management [MOSTLY COMPLETE]
- [ ] Check for weak or missing multi-factor authentication (MFA)
- [x] Session handling reviewed: cookies use HttpOnly, Secure flags
- [x] Logout endpoint verified to invalidate sessions

3. Cross-Site Scripting (XSS) [in-progress]
- [x] SonarLint scanning enabled for XSS detection
- [ ] Test reflected XSS in input fields
- [ ] Test stored XSS in feed/comments

4. Access Control [‚úÖ COMPLETE]
- [x] Try accessing restricted pages without auth - PASSED (returns 401/404)
- [x] Test horizontal privilege escalation - PROTECTED by session tokens
- [x] Test vertical privilege escalation - PROTECTED by is_admin checks

5. Security Misconfigurations [MOSTLY COMPLETE]
- [x] Server headers checked and CSP configured
- [x] HTTPS enforced, X-Frame-Options replaced with CSP
- [ ] Scan for open ports and directory listings

6. Sensitive Data Exposure [MOSTLY COMPLETE]
- [x] Passwords encrypted with bcrypt_sha256
- [x] JWT tokens encrypted in transit (HTTPS)
- [ ] Verify cryptography strength (no MD5/SHA1)

7. Dependency & Library Audits [‚úÖ COMPLETE]
- [x] Run: pip-audit on requirements.txt - FIXED 16/17 vulnerabilities
- [x] Run: npm audit on package.json - CLEAN (0 vulnerabilities)
- [x] SonarLint installed for continuous monitoring
- [x] Updated all packages with available security patches

8. Cross-Site Request Forgery (CSRF) [in-progress]
- [ ] Test CSRF tokens on forms
- [ ] Verify tokens unique per session

9. Logging & Monitoring [‚úÖ COMPLETE]
- [x] Security events logged (failed logins, etc.)
- [x] Verify logs don't expose sensitive data - VERIFIED (only token=None logged)

10. Penetration Testing & Vulnerability Scanning [in-progress]
- [ ] Run OWASP ZAP dynamic testing
- [ ] Use Burp Suite for comprehensive scanning

## INSTALLED SECURITY EXTENSIONS
- [x] SonarLint (SonarSource) - Code quality & security analysis
- [x] SonarQube - Installed and configured
- [x] Aqua Trivy - Vulnerability scanner (installed, configured, CLI installed)
  - ‚úÖ Filesystem scan: CLEAN (0 vulnerabilities)
  - ‚úÖ Secret scan: CLEAN (no exposed secrets)
  - ‚úÖ Misconfiguration scan: CLEAN

## ‚ö†Ô∏è CRITICAL: DEPENDENCY VULNERABILITIES - MOSTLY FIXED ‚úÖ
**Fixed (16/17 vulnerabilities)**:
- ‚úÖ aiohttp 3.9.1 ‚Üí 3.12.14 (6 CVEs fixed)
- ‚úÖ pip 23.0.1 ‚Üí 25.3 (2 CVEs fixed)
- ‚úÖ python-jose 3.3.0 ‚Üí 3.4.0 (2 CVEs fixed)
- ‚úÖ python-multipart 0.0.6 ‚Üí 0.0.18 (2 CVEs fixed)
- ‚úÖ requests 2.31.0 ‚Üí 2.32.4 (2 CVEs fixed)
- ‚úÖ setuptools 66.1.1 ‚Üí 80.9.0 (2 CVEs fixed)

**Remaining (1/17 vulnerabilities)**:
- ‚ö†Ô∏è ecdsa 0.19.1 - CVE-2024-23342 (no fix available, latest version is 0.19.1)
  - Dependency of python-jose
  - Risk: Low impact for current usage

**Status**: Application tested successfully with updated dependencies
**Action**: Deploy to production (manual SSH required)

## SECURITY TEST RESULTS SUMMARY
‚úÖ **PASSED**:
- SQL injection protection (SQLAlchemy ORM)
- Access control (authentication required)
- Sensitive data in logs (clean)
- npm dependencies (0 vulnerabilities)
- Python dependencies (16/17 vulnerabilities fixed)

‚ö†Ô∏è **NEEDS ATTENTION**:
- 1 Python package vulnerability (ecdsa - no fix available)
- CSRF protection testing incomplete
- XSS testing incomplete
- MFA not implemented

## DEPLOYMENT STATUS
- ‚úÖ Dependencies updated locally
- ‚úÖ Application tested successfully
- ‚úÖ Production deployed and running with updated dependencies

- Mark tasks as [in-progress] or [completed] as you work.
- Add new tasks as needed.
- I can read, update, and manage this list for you automatically.
