<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NCNEQG70WC"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-NCNEQG70WC');
    </script>
    
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1529513529221142"
            crossorigin="anonymous"></script>
    
    <title>{% block title %}Nexus - The AI News Portal{% endblock %}</title>
    <link rel="icon" type="image/png" href="/static/favicon.png">
    
    <!-- Immediate dark mode initialization to prevent flash - MUST be before CSS -->
    <script>
        (function() {
            // Check localStorage for saved preference, default to dark mode
            const savedPreference = localStorage.getItem('darkMode');
            const shouldBeDark = savedPreference === null || savedPreference === 'true';
            
            if (shouldBeDark) {
                // Apply class immediately to html element
                document.documentElement.classList.add('dark-mode');
            }
        })();
    </script>
    <style>
        /* Blocking inline styles to prevent flash - applied immediately */
        html.dark-mode {
            --bg-primary: #181818 !important;
            --bg-secondary: #222222 !important;
            --bg-tertiary: #2a2a2a !important;
            --text-primary: #ffffff !important;
            --text-secondary: #cccccc !important;
            --text-muted: #999999 !important;
        }
        html.dark-mode,
        html.dark-mode body {
            background-color: #181818 !important;
            color: #ffffff !important;
        }
    </style>
    
    <!-- Base CSS -->
    <link rel="stylesheet" href="/static/css/base.css?v=202512010100">
    <link rel="stylesheet" href="/static/css/header.css?v=202512011100">
    <link rel="stylesheet" href="/static/css/components.css?v=202512010100">
    
    <!-- Page-specific CSS -->
    {% block extra_css %}{% endblock %}
</head>
<body{% if body_class %} class="{{ body_class }}"{% endif %}>
    <!-- SHARED HEADER - Edit once, applies everywhere -->
    <header class="main-header">
        <div class="container">
            <a href="/" class="header-title-link">
                <h1><img src="/static/favicon.png" alt="Nexus Logo" class="site-logo"> Nexus - The Ai News Portal</h1>
            </a>
            <nav>
                <span id="user-welcome" class="user-welcome"></span>
                <!-- Desktop auth buttons -->
                <div class="header-auth-buttons" id="header-auth-buttons">
                    <a href="/login" id="auth-btn" class="header-btn"><span class="menu-icon">ğŸ”</span><span class="menu-label">Login</span></a>
                    <a href="/register" id="register-btn" class="header-btn"><span class="menu-icon">ğŸ“</span><span class="menu-label">Register</span></a>
                </div>
                <button class="hamburger" id="hamburger-menu" aria-label="Open menu">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </button>
                <div class="nav-links" id="nav-links">
                    <a href="/" class="menu-quick"><span class="menu-icon">ğŸ </span><span class="menu-label">Feed</span></a>
                    <button id="dark-mode-toggle-menu"><span class="menu-icon">ğŸŒ™</span><span class="menu-label">Dark Mode</span></button>
                    <a href="/settings" class="menu-quick"><span class="menu-icon">âš™ï¸</span><span class="menu-label">Settings</span></a>
                    
                    <!-- Mobile auth buttons -->
                    <a href="/login" class="auth-btn-mobile" id="auth-btn-mobile"><span class="menu-icon">ğŸ”</span><span class="menu-label">Login</span></a>
                    <a href="/register" class="auth-btn-mobile" id="register-btn-mobile"><span class="menu-icon">ğŸ“</span><span class="menu-label">Register</span></a>
                    
                    <!-- Text size controls -->
                    <div class="text-size-controls">
                        <button id="text-size-decrease" class="text-size-btn" aria-label="Decrease text size">-</button>
                        <span class="text-size-label">
                            <span class="text-size-line1">Text</span>
                            <span class="text-size-line2">Size</span>
                        </span>
                        <button id="text-size-increase" class="text-size-btn" aria-label="Increase text size">+</button>
                    </div>
                </div>
            </nav>
        </div>
    </header>
    
    <!-- Page content -->
    {% block content %}{% endblock %}
    
    <!-- Shared scripts -->
    <script src="/static/js/header.js?v=202512010100"></script>
    
    <!-- Page-specific scripts -->
    {% block extra_js %}{% endblock %}
</body>
</html>

